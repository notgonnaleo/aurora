@using Backend.Domain.Entities.Orders.Request
@using Backend.Domain.Entities.Products
@using Backend.Domain.Entities.Stocks
@using Frontend.Web.Components.Products.Dropdowns
@using Frontend.Web.Services.Authentication
@using Frontend.Web.Services.Products
@inject Sotsera.Blazor.Toaster.IToaster Toaster;
@inject AuthenticationService _authenticationService;
@inject NavigationManager navigator;
@inject ProductService _productService;
@inject ProductVariantService _productVariantService

<div class="m-2 p-2">
    <i class="text ti ti-x cursor-pointer" @onclick="ToggleRightSidebar"></i>
</div>

<div class="container scroll-sidebar" style="max-height: 550px; overflow-y: auto;">
<div class="row">
    <div class="mb-2 col-sm-12">
        <ProductDropdown ProductId="SetProduct" />
    </div>
</div>

@code
{
    private Guid? selectedProductId = null;
    private Guid? selectedVariantId = null;
    private Guid? selectedEmployeeId = null;
    private Guid? selectedCustomerId = null;

    private void SetProduct(Guid productId) => selectedProductId = productId;
    private void SetVariant(Guid variantId) => selectedVariantId = variantId;
    private void SetEmployee(Guid employeeId) => selectedEmployeeId = employeeId;
    private void SetCustomer(Guid customerId) => selectedCustomerId = customerId;
}

@if (variant.Any())
{
    <div class="row">
        <div class="mb-2 col-sm-12 p-2">
            <input type="checkbox" class="form-check-input primary" id="contact-check-all" @onclick="ShowVariantsDropdown">
            <label>Insert product variant</label>
        </div>
    </div>
}

@if (isInsertVariant)
{
    <div class="row">
        <div class="mb-2 col-sm-12">
            <Frontend.Web.Components.ProductVariants.Dropdowns.VariantDropdown SelectedProductId="selectedProductId.Value" VariantId="SetVariant" />
        </div>
    </div>
}
    <div class="row">
        <div class="mb-2 col-sm-12">
            <Frontend.Web.Components.Agents.Dropdowns.EmployeeDropdown EmployeeId="SetEmployee" />
        </div>
    </div>
    <div class="row">
        <div class="mb-2 col-sm-12">
            <Frontend.Web.Components.Agents.Dropdowns.CustomerDropdown CustomerId="SetCustomer" />
        </div>
    </div>
</div>
@code 
{
    private StockDetail stock = new StockDetail();
    private IEnumerable<ProductVariant> variant = new List<ProductVariant>();

    private bool isInsertVariant = false;
    private void ShowVariantsDropdown() => isInsertVariant = !isInsertVariant;

    private bool isSelectingVariant = false;
}

@code
{
    [Parameter] public Action? ToggleRightSidebar { get; set; }
    [Parameter] public bool CollapseRightSidebar { get; set; }
}